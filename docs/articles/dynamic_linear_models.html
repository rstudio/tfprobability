<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic linear models • tfprobability</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic linear models">
<meta property="og:description" content="tfprobability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dynamic_linear_models_files/header-attrs-2.5/header-attrs.js"></script><link href="dynamic_linear_models_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="dynamic_linear_models_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dynamic linear models</h1>
                        <h4 class="author">Sigrid Keydana</h4>
            
            <h4 class="date">2021-05-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/tfprobability/blob/master/vignettes/dynamic_linear_models.Rmd"><code>vignettes/dynamic_linear_models.Rmd</code></a></small>
      <div class="hidden name"><code>dynamic_linear_models.Rmd</code></div>

    </div>

    
    
<p>In <em>state space models</em>, we assume that there is a <em>latent process</em>, hidden from our eyes; all we have are the <em>observations</em> we can make. The process evolves due to some hidden logic (<em>transition model</em>); and the way it produces the observations follows some hidden logic (<em>observation model</em>). There is noise in process evolution, and there is noise in observation. If the transition and observation models both are linear, and the process as well as observation noise are Gaussian, we have a <em>linear-Gaussian state space model</em> (SSM). The task then is to infer the latent state from the observations. The most famous technique here is the <em>Kálmán filter</em>.</p>
<p>In practical applications, two characteristics of linear-Gaussian SSMs are especially attractive.</p>
<p>For one, they let us estimate dynamically changing parameters. In regression, the parameters can be viewed as a hidden state; we may thus have a slope and an intercept that vary over time. When parameters can vary, we speak of <em>dynamic linear models</em> (DLMs). In this vignette, we introduce DLMs by way of <em>dynamic linear regression</em>.</p>
<p>Second, linear-Gaussian SSMs are useful in time-series forecasting because Gaussian processes can be <em>added</em>. A time series can thus be framed as, e.g. the sum of a linear trend and a process that varies seasonally. At the end of the vignette, we refer to a post that illustrates this application.</p>
<p>For the walkthrough of dynamic linear regression, we use an example by Petris et al.(2009), <em>Dynamic linear models with R</em>. The example applies dynamic regression to the <a href="https://en.wikipedia.org/wiki/Capital_asset_pricing_model">Capital Asset Pricing Model</a> (CAPM) data from Berndt (1991). This dataset has monthly returns, collected from January 1978 to December 1987, for four different stocks, the 30-day Treasury Bill – standing in for a <em>risk-free</em> asset –, and the value-weighted average returns for all stocks listed at the New York and American Stock Exchanges, representing the overall <em>market returns</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/tensorflow">tensorflow</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/tfprobability">tfprobability</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nteetor/zeallot">zeallot</a></span><span class="op">)</span>

<span class="co"># As the data does not seem to be available at the address given in Petris et al. any more,</span>
<span class="co"># we put it on the TensorFlow for R blog for download</span>
<span class="co"># download from:</span>
<span class="co"># https://github.com/rstudio/ai-blog/tree/master/_posts/2019-06-25-dynamic_linear_models_tfprobability/data/capm.txt</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">read_table</span><span class="op">(</span>
  <span class="st">"capm.txt"</span>,
  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fu">col_date</span><span class="op">(</span>format <span class="op">=</span> <span class="st">"%Y.%m"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>month <span class="op">=</span> <span class="va">X1</span><span class="op">)</span>
<span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Observations: 120
Variables: 7
$ month  &lt;date&gt; 1978-01-01, 1978-02-01, 1978-03-01, 1978-04-01, 1978-05-01, 19…
$ MOBIL  &lt;dbl&gt; -0.046, -0.017, 0.049, 0.077, -0.011, -0.043, 0.028, 0.056, 0.0…
$ IBM    &lt;dbl&gt; -0.029, -0.043, -0.063, 0.130, -0.018, -0.004, 0.092, 0.049, -0…
$ WEYER  &lt;dbl&gt; -0.116, -0.135, 0.084, 0.144, -0.031, 0.005, 0.164, 0.039, -0.0…
$ CITCRP &lt;dbl&gt; -0.115, -0.019, 0.059, 0.127, 0.005, 0.007, 0.032, 0.088, 0.011…
$ MARKET &lt;dbl&gt; -0.045, 0.010, 0.050, 0.063, 0.067, 0.007, 0.071, 0.079, 0.002,…
$ RKFREE &lt;dbl&gt; 0.00487, 0.00494, 0.00526, 0.00491, 0.00513, 0.00527, 0.00528, …</code></pre>
<p>The <a href="https://en.wikipedia.org/wiki/Capital_asset_pricing_model">Capital Asset Pricing Model</a> then assumes a linear relationship between the excess returns of an asset under study and the excess returns of the market. For both, <em>excess returns</em> are obtained by subtracting the returns of the chosen <em>risk-free</em> asset; then, the scaling coefficient between them reveals the asset to either be an “aggressive” investment (slope &gt; 1: changes in the market are amplified), or a conservative one (slope &lt; 1: changes are damped).</p>
<p>Assuming this relationship does not change over time, we can easily use <code>lm</code> to illustrate this. Following Petris et al. in zooming in on IBM as the asset under study, we have</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># excess returns of the asset under study</span>
<span class="va">ibm</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">IBM</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">RKFREE</span>
<span class="co"># market excess returns</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">MARKET</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">RKFREE</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ibm</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>Call:
lm(formula = ibm ~ x)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.11850 -0.03327 -0.00263  0.03332  0.15042 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.0004896  0.0046400  -0.106    0.916    
x            0.4568208  0.0675477   6.763 5.49e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.05055 on 118 degrees of freedom
Multiple R-squared:  0.2793,    Adjusted R-squared:  0.2732 
F-statistic: 45.74 on 1 and 118 DF,  p-value: 5.489e-10</code></pre>
<p>So IBM is found to be a conservative investment, the slope being ~ 0.5. But is this relationship stable over time?</p>
<p>Let’s turn to <code>tfprobability</code> to investigate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># zoom in on ibm</span>
<span class="va">ts</span> <span class="op">&lt;-</span> <span class="va">ibm</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># forecast 12 months</span>
<span class="va">n_forecast_steps</span> <span class="op">&lt;-</span> <span class="fl">12</span>
<span class="va">ts_train</span> <span class="op">&lt;-</span> <span class="va">ts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_forecast_steps</span><span class="op">)</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>

<span class="co"># make sure we work with float32 here</span>
<span class="va">ts_train</span> <span class="op">&lt;-</span> <span class="va">tf</span><span class="op">$</span><span class="fu">cast</span><span class="op">(</span><span class="va">ts_train</span>, <span class="va">tf</span><span class="op">$</span><span class="va">float32</span><span class="op">)</span>
<span class="va">ts</span> <span class="op">&lt;-</span> <span class="va">tf</span><span class="op">$</span><span class="fu">cast</span><span class="op">(</span><span class="va">ts</span>, <span class="va">tf</span><span class="op">$</span><span class="va">float32</span><span class="op">)</span></code></pre></div>
<p>In consttructing the model, <a href="https://rstudio.github.io/tfprobability/reference/sts_dynamic_linear_regression.html">sts_dynamic_linear_regression()</a> does what we want:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define the model on the complete series</span>
<span class="va">linreg</span> <span class="op">&lt;-</span> <span class="va">ts</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/sts_dynamic_linear_regression.html">sts_dynamic_linear_regression</a></span><span class="op">(</span>
    design_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">tf</span><span class="op">$</span><span class="fu">cast</span><span class="op">(</span><span class="va">tf</span><span class="op">$</span><span class="va">float32</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Now we define a function, <code>fit_with_vi</code>, that</p>
<ul>
<li>trains the model on the training set, using variational inference (<a href="https://rstudio.github.io/tfprobability/reference/sts_build_factored_variational_loss.html">sts_build_factored_variational_loss()</a>)</li>
<li>obtains forecasts using <a href="https://rstudio.github.io/tfprobability/reference/sts_forecast.html">sts_forecast()</a>
</li>
<li>obtains the smoothed as well as the filtered estimates from the <a href="https://en.wikipedia.org/wiki/Kalman_filter">Kálmán Filter</a> by converting to a <code><a href="../reference/tfd_linear_gaussian_state_space_model.html">tfd_linear_gaussian_state_space_model()</a></code> and calling <code>posterior_marginals()</code> on it:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_with_vi</span> <span class="op">&lt;-</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">ts</span>,
           <span class="va">ts_train</span>,
           <span class="va">model</span>,
           <span class="va">n_iterations</span>,
           <span class="va">n_param_samples</span>,
           <span class="va">n_forecast_steps</span>,
           <span class="va">n_forecast_samples</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="va">optimizer</span> <span class="op">&lt;-</span> <span class="va">tf</span><span class="op">$</span><span class="va">compat</span><span class="op">$</span><span class="va">v1</span><span class="op">$</span><span class="va">train</span><span class="op">$</span><span class="fu">AdamOptimizer</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>
    
    <span class="va">loss_and_dists</span> <span class="op">&lt;-</span>
      <span class="va">ts_train</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/sts_build_factored_variational_loss.html">sts_build_factored_variational_loss</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span><span class="op">)</span>
    <span class="va">variational_loss</span> <span class="op">&lt;-</span> <span class="va">loss_and_dists</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="va">train_op</span> <span class="op">&lt;-</span> <span class="va">optimizer</span><span class="op">$</span><span class="fu">minimize</span><span class="op">(</span><span class="va">variational_loss</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span> <span class="op">(</span><span class="va">tf</span><span class="op">$</span><span class="fu">Session</span><span class="op">(</span><span class="op">)</span> <span class="op">%as%</span> <span class="va">sess</span>,  <span class="op">{</span>
      
      <span class="co"># step 1: train the model using variational inference</span>
      <span class="va">sess</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">tf</span><span class="op">$</span><span class="va">compat</span><span class="op">$</span><span class="va">v1</span><span class="op">$</span><span class="fu">global_variables_initializer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
      <span class="kw">for</span> <span class="op">(</span><span class="va">step</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_iterations</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">sess</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">train_op</span><span class="op">)</span>
        <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">sess</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">variational_loss</span><span class="op">)</span>
        <span class="kw">if</span> <span class="op">(</span><span class="va">step</span> <span class="op">%%</span> <span class="fl">1</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
          <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Loss: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span>
      <span class="op">}</span>
      <span class="co"># step 2: obtain forecasts</span>
      <span class="va">variational_distributions</span> <span class="op">&lt;-</span> <span class="va">loss_and_dists</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
      <span class="va">posterior_samples</span> <span class="op">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Map</a></span><span class="op">(</span>
          <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span>
            <span class="va">d</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tfd_sample.html">tfd_sample</a></span><span class="op">(</span><span class="va">n_param_samples</span><span class="op">)</span>,
          <span class="va">variational_distributions</span> <span class="op">%&gt;%</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/r-py-conversion.html">py_to_r</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>
      <span class="va">forecast_dists</span> <span class="op">&lt;-</span>
        <span class="va">ts_train</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/sts_forecast.html">sts_forecast</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">posterior_samples</span>, <span class="va">n_forecast_steps</span><span class="op">)</span>
      <span class="va">fc_means</span> <span class="op">&lt;-</span> <span class="va">forecast_dists</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tfd_mean.html">tfd_mean</a></span><span class="op">(</span><span class="op">)</span>
      <span class="va">fc_sds</span> <span class="op">&lt;-</span> <span class="va">forecast_dists</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/tfd_stddev.html">tfd_stddev</a></span><span class="op">(</span><span class="op">)</span>
      
      <span class="co"># step 3: obtain smoothed and filtered estimates from the Kálmán filter</span>
      <span class="va">ssm</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">make_state_space_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts_train</span><span class="op">)</span>, param_vals <span class="op">=</span> <span class="va">posterior_samples</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_means</span>, <span class="va">smoothed_covs</span><span class="op">)</span> <span class="op">%&lt;-%</span> <span class="va">ssm</span><span class="op">$</span><span class="fu">posterior_marginals</span><span class="op">(</span><span class="va">ts_train</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">filtered_means</span>, <span class="va">filtered_covs</span>, <span class="va">.</span>, <span class="va">.</span>, <span class="va">.</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&lt;-%</span> <span class="va">ssm</span><span class="op">$</span><span class="fu">forward_filter</span><span class="op">(</span><span class="va">ts_train</span><span class="op">)</span>
   
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">posterior_samples</span>, <span class="va">fc_means</span>, <span class="va">fc_sds</span>, <span class="va">smoothed_means</span>, <span class="va">smoothed_covs</span>, <span class="va">filtered_means</span>, <span class="va">filtered_covs</span><span class="op">)</span> <span class="op">%&lt;-%</span>
        <span class="va">sess</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">posterior_samples</span>, <span class="va">fc_means</span>, <span class="va">fc_sds</span>, <span class="va">smoothed_means</span>, <span class="va">smoothed_covs</span>, <span class="va">filtered_means</span>, <span class="va">filtered_covs</span><span class="op">)</span><span class="op">)</span>
      
    <span class="op">}</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="va">variational_distributions</span>,
      <span class="va">posterior_samples</span>,
      <span class="va">fc_means</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
      <span class="va">fc_sds</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
      <span class="va">smoothed_means</span>,
      <span class="va">smoothed_covs</span>,
      <span class="va">filtered_means</span>,
      <span class="va">filtered_covs</span>
    <span class="op">)</span>
  <span class="op">}</span></code></pre></div>
<p>Now we’re ready to call that function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># number of VI steps</span>
<span class="va">n_iterations</span> <span class="op">&lt;-</span> <span class="fl">300</span>
<span class="co"># sample size for posterior samples</span>
<span class="va">n_param_samples</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="co"># sample size to draw from the forecast distribution</span>
<span class="va">n_forecast_samples</span> <span class="op">&lt;-</span> <span class="fl">50</span>

<span class="co"># call fit_vi defined above</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="va">param_distributions</span>,
  <span class="va">param_samples</span>,
  <span class="va">fc_means</span>,
  <span class="va">fc_sds</span>,
  <span class="va">smoothed_means</span>,
  <span class="va">smoothed_covs</span>,
  <span class="va">filtered_means</span>,
  <span class="va">filtered_covs</span>
<span class="op">)</span> <span class="op">%&lt;-%</span> <span class="fu">fit_vi</span><span class="op">(</span>
  <span class="va">ts</span>,
  <span class="va">ts_train</span>,
  <span class="va">model</span>,
  <span class="va">n_iterations</span>,
  <span class="va">n_param_samples</span>,
  <span class="va">n_forecast_steps</span>,
  <span class="va">n_forecast_samples</span>
<span class="op">)</span></code></pre></div>
<p>Let’s look at the forecasts and filtering resp. smoothing estimates.</p>
<p>Putting all we need into one dataframe, we have</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smoothed_means_intercept</span> <span class="op">&lt;-</span> <span class="va">smoothed_means</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">smoothed_means_slope</span> <span class="op">&lt;-</span> <span class="va">smoothed_means</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">smoothed_sds_intercept</span> <span class="op">&lt;-</span> <span class="va">smoothed_covs</span><span class="op">[</span>, , <span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">smoothed_sds_slope</span> <span class="op">&lt;-</span> <span class="va">smoothed_covs</span><span class="op">[</span>, , <span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">filtered_means_intercept</span> <span class="op">&lt;-</span> <span class="va">filtered_means</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">filtered_means_slope</span> <span class="op">&lt;-</span> <span class="va">filtered_means</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">filtered_sds_intercept</span> <span class="op">&lt;-</span> <span class="va">filtered_covs</span><span class="op">[</span>, , <span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">filtered_sds_slope</span> <span class="op">&lt;-</span> <span class="va">filtered_covs</span><span class="op">[</span>, , <span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">forecast_df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">month</span>, <span class="va">IBM</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>pred_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts_train</span><span class="op">)</span><span class="op">)</span>, <span class="va">fc_means</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>pred_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts_train</span><span class="op">)</span><span class="op">)</span>, <span class="va">fc_sds</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>smoothed_means_intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_means_intercept</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>smoothed_means_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_means_slope</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>smoothed_sds_intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_sds_intercept</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>smoothed_sds_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_sds_slope</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>filtered_means_intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">filtered_means_intercept</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>filtered_means_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">filtered_means_slope</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>filtered_sds_intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">filtered_sds_intercept</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_column</span><span class="op">(</span>filtered_sds_slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">filtered_sds_slope</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n_forecast_steps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Here first are the forecasts.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">forecast_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">IBM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred_mean</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"cyan"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">pred_mean</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pred_sd</span>, ymax <span class="op">=</span> <span class="va">pred_mean</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pred_sd</span><span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">0.2</span>,
    fill <span class="op">=</span> <span class="st">"cyan"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/capm_forecast.png" alt="12-point-ahead forecasts for IBM; posterior means +/- 2 standard deviations." width="500"><p class="caption">
12-point-ahead forecasts for IBM; posterior means +/- 2 standard deviations.
</p>
</div>
<p>Here are the smoothing estimates. The intercept (shown in orange) remains pretty stable over time, but we do see a trend in the slope (displayed in green).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">forecast_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">smoothed_means_intercept</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">smoothed_means_slope</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      ymin <span class="op">=</span> <span class="va">smoothed_means_intercept</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">smoothed_sds_intercept</span>,
      ymax <span class="op">=</span> <span class="va">smoothed_means_intercept</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">smoothed_sds_intercept</span>
    <span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">0.3</span>,
    fill <span class="op">=</span> <span class="st">"orange"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      ymin <span class="op">=</span> <span class="va">smoothed_means_slope</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">smoothed_sds_slope</span>,
      ymax <span class="op">=</span> <span class="va">smoothed_means_slope</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">smoothed_sds_slope</span>
    <span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">0.1</span>,
    fill <span class="op">=</span> <span class="st">"green"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">forecast_df</span><span class="op">$</span><span class="va">month</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">forecast_df</span><span class="op">$</span><span class="va">month</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_forecast_steps</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/capm_smoothed.png" alt="Smoothing estimates from the Kálmán filter. Green: coefficient for dependence on excess market returns (slope), orange: vector of ones (intercept)." width="500"><p class="caption">
Smoothing estimates from the Kálmán filter. Green: coefficient for dependence on excess market returns (slope), orange: vector of ones (intercept).
</p>
</div>
<p>For comparison, this is how the filtered estimates look.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">forecast_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">filtered_means_intercept</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">filtered_means_slope</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      ymin <span class="op">=</span> <span class="va">filtered_means_intercept</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">filtered_sds_intercept</span>,
      ymax <span class="op">=</span> <span class="va">filtered_means_intercept</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">filtered_sds_intercept</span>
    <span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">0.3</span>,
    fill <span class="op">=</span> <span class="st">"orange"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>
      ymin <span class="op">=</span> <span class="va">filtered_means_slope</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">filtered_sds_slope</span>,
      ymax <span class="op">=</span> <span class="va">filtered_means_slope</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">filtered_sds_slope</span>
    <span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">0.1</span>,
    fill <span class="op">=</span> <span class="st">"green"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
                  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">forecast_df</span><span class="op">$</span><span class="va">month</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">forecast_df</span><span class="op">$</span><span class="va">month</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_forecast_steps</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/capm_filtered.png" alt="Filtering estimates from the Kálmán filter. Green: coefficient for dependence on excess market returns (slope), orange: vector of ones (intercept)." width="500"><p class="caption">
Filtering estimates from the Kálmán filter. Green: coefficient for dependence on excess market returns (slope), orange: vector of ones (intercept).
</p>
</div>
<p>For an example illustrating the additivity feature of DLMs – that allows us to <em>decompose</em> a time series into its constituents –, as well as for more narrative on the above example, see <a href="https://blogs.rstudio.com/ai/posts/2019-06-25-dynamic_linear_models_tfprobability/">Dynamic linear models with tfprobability</a> on the TensorFlow for R blog.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

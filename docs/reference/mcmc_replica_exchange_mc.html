<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Runs one step of the Replica Exchange Monte Carlo — mcmc_replica_exchange_mc • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Runs one step of the Replica Exchange Monte Carlo — mcmc_replica_exchange_mc" />
<meta property="og:description" content="Replica Exchange Monte Carlo
is a Markov chain Monte Carlo (MCMC) algorithm that is also known as Parallel Tempering.
This algorithm performs multiple sampling with different temperatures in parallel,
and exchanges those samplings according to the Metropolis-Hastings criterion.
The K replicas are parameterized in terms of inverse_temperature's,
(beta[0], beta[1], ..., beta[K-1]).  If the target distribution has
probability density p(x), the kth replica has density p(x)**beta_k." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.12.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs one step of the Replica Exchange Monte Carlo</h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/mcmc-kernels.R'><code>R/mcmc-kernels.R</code></a></small>
    <div class="hidden name"><code>mcmc_replica_exchange_mc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://en.wikipedia.org/wiki/Parallel_tempering'>Replica Exchange Monte Carlo</a>
is a Markov chain Monte Carlo (MCMC) algorithm that is also known as Parallel Tempering.
This algorithm performs multiple sampling with different temperatures in parallel,
and exchanges those samplings according to the Metropolis-Hastings criterion.
The <code>K</code> replicas are parameterized in terms of <code>inverse_temperature</code>'s,
<code>(beta[0], beta[1], ..., beta[K-1])</code>.  If the target distribution has
probability density <code>p(x)</code>, the <code>kth</code> replica has density <code>p(x)**beta_k</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>mcmc_replica_exchange_mc</span><span class='op'>(</span>
  <span class='va'>target_log_prob_fn</span>,
  <span class='va'>inverse_temperatures</span>,
  <span class='va'>make_kernel_fn</span>,
  swap_proposal_fn <span class='op'>=</span> <span class='va'>tfp</span><span class='op'>$</span><span class='va'>mcmc</span><span class='op'>$</span><span class='va'>replica_exchange_mc</span><span class='op'>$</span><span class='fu'>default_swap_proposal_fn</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>,
  state_includes_replicas <span class='op'>=</span> <span class='cn'>FALSE</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>target_log_prob_fn</th>
      <td><p>Function which takes an argument like
<code>current_state</code> (if it's a list <code>current_state</code> will be unpacked) and returns its
(possibly unnormalized) log-density under the target distribution.</p></td>
    </tr>
    <tr>
      <th>inverse_temperatures</th>
      <td><p><code>1D</code> Tensor of inverse temperatures to perform
samplings with each replica. Must have statically known <code>shape</code>.
<code>inverse_temperatures[0]</code> produces the states returned by samplers,
and is typically == 1.</p></td>
    </tr>
    <tr>
      <th>make_kernel_fn</th>
      <td><p>Function which takes target_log_prob_fn and seed
args and returns a TransitionKernel instance.</p></td>
    </tr>
    <tr>
      <th>swap_proposal_fn</th>
      <td><p>function which take a number of replicas, and
return combinations of replicas for exchange.</p></td>
    </tr>
    <tr>
      <th>state_includes_replicas</th>
      <td><p>Boolean indicating whether the leftmost dimension
of each state sample should index replicas. If <code>TRUE</code>, the leftmost
dimension of the <code>current_state</code> kwarg to <code>tfp.mcmc.sample_chain</code> will
be interpreted as indexing replicas.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>integer to seed the random number generator.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>string prefixed to Ops created by this function.
Default value: <code>NULL</code> (i.e., "remc_kernel").</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list of
<code>next_state</code> (Tensor or Python list of <code>Tensor</code>s representing the state(s)
of the Markov chain(s) at each result step. Has same shape as
and <code>current_state</code>.) and
<code>kernel_results</code> (<code>collections$namedtuple</code> of internal calculations used to
'advance the chain).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Typically <code>beta[0] = 1.0</code>, and <code>1.0 &gt; beta[1] &gt; beta[2] &gt; ... &gt; 0.0</code>.</p><ul>
<li><p><code>beta[0] == 1</code> ==&gt; First replicas samples from the target density, <code>p</code>.</p></li>
<li><p><code>beta[k] &lt; 1</code>, for <code>k = 1, ..., K-1</code> ==&gt; Other replicas sample from
"flattened" versions of <code>p</code> (peak is less high, valley less low).  These
distributions are somewhat closer to a uniform on the support of <code>p</code>.
Samples from adjacent replicas <code>i</code>, <code>i + 1</code> are used as proposals for each
other in a Metropolis step.  This allows the lower <code>beta</code> samples, which
explore less dense areas of <code>p</code>, to occasionally be used to help the
<code>beta == 1</code> chain explore new regions of the support.
Samples from replica 0 are returned, and the others are discarded.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other mcmc_kernels: 
<code><a href='mcmc_dual_averaging_step_size_adaptation.html'>mcmc_dual_averaging_step_size_adaptation</a>()</code>,
<code><a href='mcmc_hamiltonian_monte_carlo.html'>mcmc_hamiltonian_monte_carlo</a>()</code>,
<code><a href='mcmc_metropolis_adjusted_langevin_algorithm.html'>mcmc_metropolis_adjusted_langevin_algorithm</a>()</code>,
<code><a href='mcmc_metropolis_hastings.html'>mcmc_metropolis_hastings</a>()</code>,
<code><a href='mcmc_no_u_turn_sampler.html'>mcmc_no_u_turn_sampler</a>()</code>,
<code><a href='mcmc_random_walk_metropolis.html'>mcmc_random_walk_metropolis</a>()</code>,
<code><a href='mcmc_simple_step_size_adaptation.html'>mcmc_simple_step_size_adaptation</a>()</code>,
<code><a href='mcmc_slice_sampler.html'>mcmc_slice_sampler</a>()</code>,
<code><a href='mcmc_transformed_transition_kernel.html'>mcmc_transformed_transition_kernel</a>()</code>,
<code><a href='mcmc_uncalibrated_hamiltonian_monte_carlo.html'>mcmc_uncalibrated_hamiltonian_monte_carlo</a>()</code>,
<code><a href='mcmc_uncalibrated_langevin.html'>mcmc_uncalibrated_langevin</a>()</code>,
<code><a href='mcmc_uncalibrated_random_walk.html'>mcmc_uncalibrated_random_walk</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>State space model for an autoregressive process. — sts_autoregressive_state_space_model • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="State space model for an autoregressive process. — sts_autoregressive_state_space_model" />
<meta property="og:description" content="A state space model (SSM) posits a set of latent (unobserved) variables that
evolve over time with dynamics specified by a probabilistic transition model
p(z[t+1] | z[t]). At each timestep, we observe a value sampled from an
observation model conditioned on the current state, p(x[t] | z[t]). The
special case where both the transition and observation models are Gaussians
with mean specified as a linear function of the inputs, is known as a linear
Gaussian state space model and supports tractable exact probabilistic
calculations; see tfd_linear_gaussian_state_space_model for
details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>State space model for an autoregressive process.</h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/sts.R'><code>R/sts.R</code></a></small>
    <div class="hidden name"><code>sts_autoregressive_state_space_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A state space model (SSM) posits a set of latent (unobserved) variables that
evolve over time with dynamics specified by a probabilistic transition model
<code>p(z[t+1] | z[t])</code>. At each timestep, we observe a value sampled from an
observation model conditioned on the current state, <code>p(x[t] | z[t])</code>. The
special case where both the transition and observation models are Gaussians
with mean specified as a linear function of the inputs, is known as a linear
Gaussian state space model and supports tractable exact probabilistic
calculations; see <code>tfd_linear_gaussian_state_space_model</code> for
details.</p>
    </div>

    <pre class="usage"><span class='fu'>sts_autoregressive_state_space_model</span><span class='op'>(</span>
  <span class='va'>num_timesteps</span>,
  <span class='va'>coefficients</span>,
  <span class='va'>level_scale</span>,
  <span class='va'>initial_state_prior</span>,
  observation_noise_scale <span class='op'>=</span> <span class='fl'>0</span>,
  initial_step <span class='op'>=</span> <span class='fl'>0</span>,
  validate_args <span class='op'>=</span> <span class='cn'>FALSE</span>,
  name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>num_timesteps</th>
      <td><p>Scalar <code>integer</code> <code>tensor</code> number of timesteps to model
with this distribution.</p></td>
    </tr>
    <tr>
      <th>coefficients</th>
      <td><p><code>float</code> <code>tensor</code> of shape <code>tf$concat(batch_shape, list(order))</code>
defining  the autoregressive coefficients. The coefficients are defined
backwards in time:
<code>coefficients[0] * level[t] + coefficients[1] * level[t-1] + ... + coefficients[order-1] * level[t-order+1]</code>.</p></td>
    </tr>
    <tr>
      <th>level_scale</th>
      <td><p>Scalar (any additional dimensions are treated as batch
dimensions) <code>float</code> <code>tensor</code> indicating the standard deviation of the
transition noise at each step.</p></td>
    </tr>
    <tr>
      <th>initial_state_prior</th>
      <td><p>instance of <code>tfd_multivariate_normal</code> representing
the prior distribution on latent states.  Must have event shape <code><a href='https://rdrr.io/r/base/list.html'>list(order)</a></code>.</p></td>
    </tr>
    <tr>
      <th>observation_noise_scale</th>
      <td><p>Scalar (any additional dimensions are
treated as batch dimensions) <code>float</code> <code>tensor</code> indicating the standard
deviation of the observation noise. Default value: 0.</p></td>
    </tr>
    <tr>
      <th>initial_step</th>
      <td><p>Optional scalar <code>int</code> <code>tensor</code> specifying the starting
timestep. Default value: 0.</p></td>
    </tr>
    <tr>
      <th>validate_args</th>
      <td><p><code>logical</code>. Whether to validate input
with asserts. If <code>validate_args</code> is <code>FALSE</code>, and the inputs are
invalid, correct behavior is not guaranteed. Default value: <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name prefixed to ops created by this class. Default value: "AutoregressiveStateSpaceModel".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an instance of <code>LinearGaussianStateSpaceModel</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In an autoregressive process, the expected level at each timestep is a linear
function of previous levels, with added Gaussian noise:</p><pre><span class='va'>level</span><span class='op'>[</span><span class='va'>t</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>coefficients</span> <span class='op'>*</span> <span class='va'>levels</span><span class='op'>[</span><span class='va'>t</span><span class='op'>:</span><span class='va'>t</span><span class='op'>-</span><span class='va'>order</span><span class='op'>:</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>Normal</a></span><span class='op'>(</span><span class='fl'>0.</span>, <span class='va'>level_scale</span><span class='op'>)</span><span class='op'>)</span>
</pre>

<p>The process is characterized by a vector <code>coefficients</code> whose size determines
the order of the process (how many previous values it looks at), and by
<code>level_scale</code>, the standard deviation of the noise added at each step.
This is formulated as a state space model by letting the latent state encode
the most recent values; see 'Mathematical Details' below.</p>
<p>The parameters <code>level_scale</code> and <code>observation_noise_scale</code> are each (a batch
of) scalars, and <code>coefficients</code> is a (batch) vector of size <code><a href='https://rdrr.io/r/base/list.html'>list(order)</a></code>. The
batch shape of this <code>Distribution</code> is the broadcast batch
shape of these parameters and of the <code>initial_state_prior</code>.</p>
<p>Mathematical Details</p>
<p>The autoregressive model implements a
<code>tfd_linear_gaussian_state_space_model</code> with <code>latent_size = order</code>
and <code>observation_size = 1</code>. The latent state vector encodes the recent history
of the process, with the current value in the topmost dimension. At each
timestep, the transition sums the previous values to produce the new expected
value, shifts all other values down by a dimension, and adds noise to the
current value. This is formally encoded by the transition model:</p><pre>transition_matrix = [ coefs[0], coefs[1], ..., coefs[order]
                      1.,       0 ,       ..., 0.
                      0.,       1.,       ..., 0.
                      ...
                      0.,       0.,  ...,  1., 0.         ]
</pre><pre>transition_noise ~ N(loc=0., scale=diag([level_scale, 0., 0., ..., 0.]))
</pre>

<p>The observation model simply extracts the current (topmost) value, and
optionally adds independent noise at each step:</p><pre>observation_matrix = [[1., 0., ..., 0.]]
observation_noise ~ N(loc=0, scale=observation_noise_scale)
</pre>

<p>Models with <code>observation_noise_scale = 0</code> are AR processes in the formal
sense. Setting <code>observation_noise_scale</code> to a nonzero value corresponds to a
latent AR process observed under an iid noise model.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other sts: 
<code><a href='sts_additive_state_space_model.html'>sts_additive_state_space_model</a>()</code>,
<code><a href='sts_autoregressive.html'>sts_autoregressive</a>()</code>,
<code><a href='sts_constrained_seasonal_state_space_model.html'>sts_constrained_seasonal_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression_state_space_model.html'>sts_dynamic_linear_regression_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression.html'>sts_dynamic_linear_regression</a>()</code>,
<code><a href='sts_linear_regression.html'>sts_linear_regression</a>()</code>,
<code><a href='sts_local_level_state_space_model.html'>sts_local_level_state_space_model</a>()</code>,
<code><a href='sts_local_level.html'>sts_local_level</a>()</code>,
<code><a href='sts_local_linear_trend_state_space_model.html'>sts_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_local_linear_trend.html'>sts_local_linear_trend</a>()</code>,
<code><a href='sts_seasonal_state_space_model.html'>sts_seasonal_state_space_model</a>()</code>,
<code><a href='sts_seasonal.html'>sts_seasonal</a>()</code>,
<code><a href='sts_semi_local_linear_trend_state_space_model.html'>sts_semi_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_semi_local_linear_trend.html'>sts_semi_local_linear_trend</a>()</code>,
<code><a href='sts_smooth_seasonal_state_space_model.html'>sts_smooth_seasonal_state_space_model</a>()</code>,
<code><a href='sts_smooth_seasonal.html'>sts_smooth_seasonal</a>()</code>,
<code><a href='sts_sparse_linear_regression.html'>sts_sparse_linear_regression</a>()</code>,
<code><a href='sts_sum.html'>sts_sum</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Formal representation of a sparse linear regression. — sts_sparse_linear_regression • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Formal representation of a sparse linear regression. — sts_sparse_linear_regression" />
<meta property="og:description" content="This model defines a time series given by a sparse linear combination of
covariate time series provided in a design matrix:" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.12.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Formal representation of a sparse linear regression.</h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/sts.R'><code>R/sts.R</code></a></small>
    <div class="hidden name"><code>sts_sparse_linear_regression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This model defines a time series given by a sparse linear combination of
covariate time series provided in a design matrix:</p>
    </div>

    <pre class="usage"><span class='fu'>sts_sparse_linear_regression</span><span class='op'>(</span>
  <span class='va'>design_matrix</span>,
  weights_prior_scale <span class='op'>=</span> <span class='fl'>0.1</span>,
  weights_batch_shape <span class='op'>=</span> <span class='cn'>NULL</span>,
  name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>design_matrix</th>
      <td><p>float <code>tensor</code> of shape <code>tf$concat(list(batch_shape, list(num_timesteps, num_features)))</code>.
This may also optionally be an instance of <code>tf$linalg$LinearOperator</code>.</p></td>
    </tr>
    <tr>
      <th>weights_prior_scale</th>
      <td><p>float <code>Tensor</code> defining the scale of the Horseshoe
prior on regression weights. Small values encourage the weights to be
sparse. The shape must broadcast with <code>weights_batch_shape</code>.
Default value: <code>0.1</code>.</p></td>
    </tr>
    <tr>
      <th>weights_batch_shape</th>
      <td><p>if <code>NULL</code>, defaults to
<code>design_matrix.batch_shape_tensor()</code>. Must broadcast with the batch
shape of <code>design_matrix</code>. Default value: <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>the name of this model component. Default value: 'LinearRegression'.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an instance of <code>StructuralTimeSeries</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<pre><span class='va'>observed_time_series</span> <span class='op'>&lt;-</span> <span class='va'>tf</span><span class='op'>$</span><span class='fu'>matmul</span><span class='op'>(</span><span class='va'>design_matrix</span>, <span class='va'>weights</span><span class='op'>)</span>
</pre>

<p>This is identical to <code>sts_linear_regression</code>, except that
<code>sts_sparse_linear_regression</code> uses a parameterization of a Horseshoe
prior to encode the assumption that many of the <code>weights</code> are zero,
i.e., many of the covariate time series are irrelevant. See the mathematical
details section below for further discussion. The prior parameterization used
by <code>sts_sparse_linear_regression</code> is more suitable for inference than that
obtained by simply passing the equivalent <code>tfd_horseshoe</code> prior to
<code>sts_linear_regression</code>; when sparsity is desired, <code>sts_sparse_linear_regression</code> will
likely yield better results.</p>
<p>This component does not itself include observation noise; it defines a
deterministic distribution with mass at the point
<code>tf$matmul(design_matrix, weights)</code>. In practice, it should be combined with
observation noise from another component such as <code>sts_sum</code>.</p>
<p>Mathematical Details</p>
<p>The basic horseshoe prior Carvalho et al. (2009) is defined as a Cauchy-normal scale mixture:</p><pre>scales[i] ~ HalfCauchy(loc=0, scale=1)
weights[i] ~ Normal(loc=0., scale=scales[i] * global_scale)`
</pre>

<p>The Cauchy scale parameters puts substantial mass near zero, encouraging
weights to be sparse, but their heavy tails allow weights far from zero to be
estimated without excessive shrinkage. The horseshoe can be thought of as a
continuous relaxation of a traditional 'spike-and-slab' discrete sparsity
prior, in which the latent Cauchy scale mixes between 'spike'
(<code>scales[i] ~= 0</code>) and 'slab' (<code>scales[i] &gt;&gt; 0</code>) regimes.</p>
<p>Following the recommendations in Piironen et al. (2017), <code>SparseLinearRegression</code> implements
a horseshoe with the following adaptations:</p><ul>
<li><p>The Cauchy prior on <code>scales[i]</code> is represented as an InverseGamma-Normal
compound.</p></li>
<li><p>The <code>global_scale</code> parameter is integrated out following a <code><a href='https://rdrr.io/r/stats/Cauchy.html'>Cauchy(0., scale=weights_prior_scale)</a></code> hyperprior, which is also represented as an
InverseGamma-Normal compound.</p></li>
<li><p>All compound distributions are implemented using a non-centered
parameterization.
The compound, non-centered representation defines the same marginal prior as
the original horseshoe (up to integrating out the global scale),
but allows samplers to mix more efficiently through the heavy tails; for
variational inference, the compound representation implicity expands the
representational power of the variational model.</p></li>
</ul>

<p>Note that we do not yet implement the regularized ('Finnish') horseshoe,
proposed in Piironen et al. (2017) for models with weak likelihoods, because the likelihood
in STS models is typically Gaussian, where it's not clear that additional
regularization is appropriate. If you need this functionality, please
email tfprobability@tensorflow.org.</p>
<p>The full prior parameterization implemented in <code>SparseLinearRegression</code> is
as follows:</p><pre>Sample global_scale from Cauchy(0, scale=weights_prior_scale).
global_scale_variance ~ InverseGamma(alpha=0.5, beta=0.5)
global_scale_noncentered ~ HalfNormal(loc=0, scale=1)
global_scale = (global_scale_noncentered *
sqrt(global_scale_variance) *
weights_prior_scale)
Sample local_scales from Cauchy(0, 1).
local_scale_variances[i] ~ InverseGamma(alpha=0.5, beta=0.5)
local_scales_noncentered[i] ~ HalfNormal(loc=0, scale=1)
local_scales[i] = local_scales_noncentered[i] * sqrt(local_scale_variances[i])
weights[i] ~ Normal(loc=0., scale=local_scales[i] * global_scale)
</pre>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<ul>
<li><p><a href='http://proceedings.mlr.press/v5/carvalho09a/carvalho09a.pdf'>Carvalho, C., Polson, N. and Scott, J. Handling Sparsity via the Horseshoe. AISTATS (2009).</a></p></li>
<li><p><a href='https://arxiv.org/abs/1707.01694'>Juho Piironen, Aki Vehtari. Sparsity information and regularization in the horseshoe and other shrinkage priors (2017).</a></p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For usage examples see <code><a href='sts_fit_with_hmc.html'>sts_fit_with_hmc()</a></code>, <code><a href='sts_forecast.html'>sts_forecast()</a></code>, <code><a href='sts_decompose_by_component.html'>sts_decompose_by_component()</a></code>.</p>
<p>Other sts: 
<code><a href='sts_additive_state_space_model.html'>sts_additive_state_space_model</a>()</code>,
<code><a href='sts_autoregressive_state_space_model.html'>sts_autoregressive_state_space_model</a>()</code>,
<code><a href='sts_autoregressive.html'>sts_autoregressive</a>()</code>,
<code><a href='sts_constrained_seasonal_state_space_model.html'>sts_constrained_seasonal_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression_state_space_model.html'>sts_dynamic_linear_regression_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression.html'>sts_dynamic_linear_regression</a>()</code>,
<code><a href='sts_linear_regression.html'>sts_linear_regression</a>()</code>,
<code><a href='sts_local_level_state_space_model.html'>sts_local_level_state_space_model</a>()</code>,
<code><a href='sts_local_level.html'>sts_local_level</a>()</code>,
<code><a href='sts_local_linear_trend_state_space_model.html'>sts_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_local_linear_trend.html'>sts_local_linear_trend</a>()</code>,
<code><a href='sts_seasonal_state_space_model.html'>sts_seasonal_state_space_model</a>()</code>,
<code><a href='sts_seasonal.html'>sts_seasonal</a>()</code>,
<code><a href='sts_semi_local_linear_trend_state_space_model.html'>sts_semi_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_semi_local_linear_trend.html'>sts_semi_local_linear_trend</a>()</code>,
<code><a href='sts_smooth_seasonal_state_space_model.html'>sts_smooth_seasonal_state_space_model</a>()</code>,
<code><a href='sts_smooth_seasonal.html'>sts_smooth_seasonal</a>()</code>,
<code><a href='sts_sum.html'>sts_sum</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



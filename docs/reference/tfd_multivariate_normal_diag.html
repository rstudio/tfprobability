<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multivariate normal distribution on <code>R^k</code> — tfd_multivariate_normal_diag • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multivariate normal distribution on <code>R^k</code> — tfd_multivariate_normal_diag" />
<meta property="og:description" content="The Multivariate Normal distribution is defined over R^k`` and parameterized by a (batch of) length-k loc vector (aka &quot;mu&quot;) and a (batch of) k x kscale matrix;covariance = scale @ scale.Twhere@` denotes
matrix-multiplication." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multivariate normal distribution on <code>R^k</code></h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/distributions.R'><code>R/distributions.R</code></a></small>
    <div class="hidden name"><code>tfd_multivariate_normal_diag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Multivariate Normal distribution is defined over <code>R^k`` and parameterized by a (batch of) length-k loc vector (aka "mu") and a (batch of) </code>k x k<code>scale matrix;</code>covariance = scale @ scale.T<code>where</code>@` denotes
matrix-multiplication.</p>
    </div>

    <pre class="usage"><span class='fu'>tfd_multivariate_normal_diag</span>(
  <span class='kw'>loc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>scale_diag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>scale_identity_multiplier</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>validate_args</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>allow_nan_stats</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"MultivariateNormalDiag"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>loc</th>
      <td><p>Floating-point Tensor. If this is set to NULL, loc is implicitly 0.
When specified, may have shape <code>[B1, ..., Bb, k]</code> where b &gt;= 0 and k is the event size.</p></td>
    </tr>
    <tr>
      <th>scale_diag</th>
      <td><p>Non-zero, floating-point Tensor representing a diagonal matrix added to scale.
May have shape <code>[B1, ..., Bb, k]</code>, b &gt;= 0, and characterizes b-batches of <code>k x k</code> diagonal matrices
added to scale. When both scale_identity_multiplier and scale_diag are NULL then scale
is the Identity.</p></td>
    </tr>
    <tr>
      <th>scale_identity_multiplier</th>
      <td><p>Non-zero, floating-point Tensor representing a scaled-identity-matrix
added to scale. May have shape <code>[B1, ..., Bb]</code>, b &gt;= 0, and characterizes b-batches of scaled
<code>k x k</code> identity matrices added to scale. When both scale_identity_multiplier and scale_diag
are NULL then scale is the Identity.</p></td>
    </tr>
    <tr>
      <th>validate_args</th>
      <td><p>Logical, default FALSE. When TRUE distribution parameters are checked
for validity despite possibly degrading runtime performance. When FALSE invalid inputs may
silently render incorrect outputs. Default value: FALSE.</p></td>
    </tr>
    <tr>
      <th>allow_nan_stats</th>
      <td><p>Logical, default TRUE. When TRUE, statistics (e.g., mean, mode, variance)
use the value NaN to indicate the result is undefined. When FALSE, an exception is raised if
one or more of the statistic's batch members are undefined.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name prefixed to Ops created by this class.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a distribution instance.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Mathematical Details</p>
<p>The probability density function (pdf) is,</p><pre>pdf(x; loc, scale) = exp(-0.5 ||y||**2) / Z
y = inv(scale) @ (x - loc)
Z = (2 pi)**(0.5 k) |det(scale)|
</pre>

<p>where:</p><ul>
<li><p><code>loc</code> is a vector in <code>R^k</code>,</p></li>
<li><p><code>scale</code> is a linear operator in <code>R^{k x k}</code>, <code>cov = scale @ scale.T</code>,</p></li>
<li><p><code>Z</code> denotes the normalization constant, and,</p></li>
<li><p><code>||y||**2</code> denotes the squared Euclidean norm of <code>y</code>.</p></li>
</ul>

<p>A (non-batch) <code>scale</code> matrix is:</p><pre><span class='no'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>scale_diag</span> + <span class='no'>scale_identity_multiplier</span> * <span class='fu'>ones</span>(<span class='no'>k</span>))</pre>

<p>where:</p><ul>
<li><p><code>scale_diag.shape = [k]</code>, and,</p></li>
<li><p><code>scale_identity_multiplier.shape = []</code>.#'</p></li>
</ul>

<p>Additional leading dimensions (if any) will index batches.</p>
<p>If both <code>scale_diag</code> and <code>scale_identity_multiplier</code> are <code>NULL</code>, then
<code>scale</code> is the Identity matrix.
The MultivariateNormal distribution is a member of the
<a href='https://en.wikipedia.org/wiki/Location-scale_family'>location-scale family</a>, i.e., it can be
constructed as,</p><pre><span class='no'>X</span> ~ <span class='fu'>MultivariateNormal</span>(<span class='kw'>loc</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>1</span>)   <span class='co'># Identity scale, zero shift.</span>
<span class='no'>Y</span> <span class='kw'>=</span> <span class='no'>scale</span> @ <span class='kw'>X</span> + <span class='no'>loc</span></pre>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For usage examples see e.g. <code><a href='tfd_sample.html'>tfd_sample()</a></code>, <code><a href='tfd_log_prob.html'>tfd_log_prob()</a></code>, <code><a href='tfd_mean.html'>tfd_mean()</a></code>.</p>
<p>Other distributions: 
<code><a href='tfd_autoregressive.html'>tfd_autoregressive</a>()</code>,
<code><a href='tfd_batch_reshape.html'>tfd_batch_reshape</a>()</code>,
<code><a href='tfd_bates.html'>tfd_bates</a>()</code>,
<code><a href='tfd_bernoulli.html'>tfd_bernoulli</a>()</code>,
<code><a href='tfd_beta_binomial.html'>tfd_beta_binomial</a>()</code>,
<code><a href='tfd_beta.html'>tfd_beta</a>()</code>,
<code><a href='tfd_binomial.html'>tfd_binomial</a>()</code>,
<code><a href='tfd_categorical.html'>tfd_categorical</a>()</code>,
<code><a href='tfd_cauchy.html'>tfd_cauchy</a>()</code>,
<code><a href='tfd_chi2.html'>tfd_chi2</a>()</code>,
<code><a href='tfd_chi.html'>tfd_chi</a>()</code>,
<code><a href='tfd_cholesky_lkj.html'>tfd_cholesky_lkj</a>()</code>,
<code><a href='tfd_continuous_bernoulli.html'>tfd_continuous_bernoulli</a>()</code>,
<code><a href='tfd_deterministic.html'>tfd_deterministic</a>()</code>,
<code><a href='tfd_dirichlet_multinomial.html'>tfd_dirichlet_multinomial</a>()</code>,
<code><a href='tfd_dirichlet.html'>tfd_dirichlet</a>()</code>,
<code><a href='tfd_empirical.html'>tfd_empirical</a>()</code>,
<code><a href='tfd_exponential.html'>tfd_exponential</a>()</code>,
<code><a href='tfd_gamma_gamma.html'>tfd_gamma_gamma</a>()</code>,
<code><a href='tfd_gamma.html'>tfd_gamma</a>()</code>,
<code><a href='tfd_gaussian_process_regression_model.html'>tfd_gaussian_process_regression_model</a>()</code>,
<code><a href='tfd_gaussian_process.html'>tfd_gaussian_process</a>()</code>,
<code><a href='tfd_generalized_normal.html'>tfd_generalized_normal</a>()</code>,
<code><a href='tfd_geometric.html'>tfd_geometric</a>()</code>,
<code><a href='tfd_gumbel.html'>tfd_gumbel</a>()</code>,
<code><a href='tfd_half_cauchy.html'>tfd_half_cauchy</a>()</code>,
<code><a href='tfd_half_normal.html'>tfd_half_normal</a>()</code>,
<code><a href='tfd_hidden_markov_model.html'>tfd_hidden_markov_model</a>()</code>,
<code><a href='tfd_horseshoe.html'>tfd_horseshoe</a>()</code>,
<code><a href='tfd_independent.html'>tfd_independent</a>()</code>,
<code><a href='tfd_inverse_gamma.html'>tfd_inverse_gamma</a>()</code>,
<code><a href='tfd_inverse_gaussian.html'>tfd_inverse_gaussian</a>()</code>,
<code><a href='tfd_johnson_s_u.html'>tfd_johnson_s_u</a>()</code>,
<code><a href='tfd_joint_distribution_named_auto_batched.html'>tfd_joint_distribution_named_auto_batched</a>()</code>,
<code><a href='tfd_joint_distribution_named.html'>tfd_joint_distribution_named</a>()</code>,
<code><a href='tfd_joint_distribution_sequential_auto_batched.html'>tfd_joint_distribution_sequential_auto_batched</a>()</code>,
<code><a href='tfd_joint_distribution_sequential.html'>tfd_joint_distribution_sequential</a>()</code>,
<code><a href='tfd_kumaraswamy.html'>tfd_kumaraswamy</a>()</code>,
<code><a href='tfd_laplace.html'>tfd_laplace</a>()</code>,
<code><a href='tfd_linear_gaussian_state_space_model.html'>tfd_linear_gaussian_state_space_model</a>()</code>,
<code><a href='tfd_lkj.html'>tfd_lkj</a>()</code>,
<code><a href='tfd_log_logistic.html'>tfd_log_logistic</a>()</code>,
<code><a href='tfd_log_normal.html'>tfd_log_normal</a>()</code>,
<code><a href='tfd_logistic.html'>tfd_logistic</a>()</code>,
<code><a href='tfd_mixture_same_family.html'>tfd_mixture_same_family</a>()</code>,
<code><a href='tfd_mixture.html'>tfd_mixture</a>()</code>,
<code><a href='tfd_multinomial.html'>tfd_multinomial</a>()</code>,
<code><a href='tfd_multivariate_normal_diag_plus_low_rank.html'>tfd_multivariate_normal_diag_plus_low_rank</a>()</code>,
<code><a href='tfd_multivariate_normal_full_covariance.html'>tfd_multivariate_normal_full_covariance</a>()</code>,
<code><a href='tfd_multivariate_normal_linear_operator.html'>tfd_multivariate_normal_linear_operator</a>()</code>,
<code><a href='tfd_multivariate_normal_tri_l.html'>tfd_multivariate_normal_tri_l</a>()</code>,
<code><a href='tfd_multivariate_student_t_linear_operator.html'>tfd_multivariate_student_t_linear_operator</a>()</code>,
<code><a href='tfd_negative_binomial.html'>tfd_negative_binomial</a>()</code>,
<code><a href='tfd_normal.html'>tfd_normal</a>()</code>,
<code><a href='tfd_one_hot_categorical.html'>tfd_one_hot_categorical</a>()</code>,
<code><a href='tfd_pareto.html'>tfd_pareto</a>()</code>,
<code><a href='tfd_pixel_cnn.html'>tfd_pixel_cnn</a>()</code>,
<code><a href='tfd_poisson_log_normal_quadrature_compound.html'>tfd_poisson_log_normal_quadrature_compound</a>()</code>,
<code><a href='tfd_poisson.html'>tfd_poisson</a>()</code>,
<code><a href='tfd_power_spherical.html'>tfd_power_spherical</a>()</code>,
<code><a href='tfd_probit_bernoulli.html'>tfd_probit_bernoulli</a>()</code>,
<code><a href='tfd_quantized.html'>tfd_quantized</a>()</code>,
<code><a href='tfd_relaxed_bernoulli.html'>tfd_relaxed_bernoulli</a>()</code>,
<code><a href='tfd_relaxed_one_hot_categorical.html'>tfd_relaxed_one_hot_categorical</a>()</code>,
<code><a href='tfd_sample_distribution.html'>tfd_sample_distribution</a>()</code>,
<code><a href='tfd_sinh_arcsinh.html'>tfd_sinh_arcsinh</a>()</code>,
<code><a href='tfd_spherical_uniform.html'>tfd_spherical_uniform</a>()</code>,
<code><a href='tfd_student_t_process.html'>tfd_student_t_process</a>()</code>,
<code><a href='tfd_student_t.html'>tfd_student_t</a>()</code>,
<code><a href='tfd_transformed_distribution.html'>tfd_transformed_distribution</a>()</code>,
<code><a href='tfd_triangular.html'>tfd_triangular</a>()</code>,
<code><a href='tfd_truncated_cauchy.html'>tfd_truncated_cauchy</a>()</code>,
<code><a href='tfd_truncated_normal.html'>tfd_truncated_normal</a>()</code>,
<code><a href='tfd_uniform.html'>tfd_uniform</a>()</code>,
<code><a href='tfd_variational_gaussian_process.html'>tfd_variational_gaussian_process</a>()</code>,
<code><a href='tfd_vector_diffeomixture.html'>tfd_vector_diffeomixture</a>()</code>,
<code><a href='tfd_vector_exponential_diag.html'>tfd_vector_exponential_diag</a>()</code>,
<code><a href='tfd_vector_exponential_linear_operator.html'>tfd_vector_exponential_linear_operator</a>()</code>,
<code><a href='tfd_vector_laplace_diag.html'>tfd_vector_laplace_diag</a>()</code>,
<code><a href='tfd_vector_laplace_linear_operator.html'>tfd_vector_laplace_linear_operator</a>()</code>,
<code><a href='tfd_vector_sinh_arcsinh_diag.html'>tfd_vector_sinh_arcsinh_diag</a>()</code>,
<code><a href='tfd_von_mises_fisher.html'>tfd_von_mises_fisher</a>()</code>,
<code><a href='tfd_von_mises.html'>tfd_von_mises</a>()</code>,
<code><a href='tfd_weibull.html'>tfd_weibull</a>()</code>,
<code><a href='tfd_wishart_linear_operator.html'>tfd_wishart_linear_operator</a>()</code>,
<code><a href='tfd_wishart_tri_l.html'>tfd_wishart_tri_l</a>()</code>,
<code><a href='tfd_wishart.html'>tfd_wishart</a>()</code>,
<code><a href='tfd_zipf.html'>tfd_zipf</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



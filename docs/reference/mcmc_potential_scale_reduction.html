<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gelman and Rubin (1992)'s potential scale reduction for chain convergence. — mcmc_potential_scale_reduction • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Gelman and Rubin (1992)'s potential scale reduction for chain convergence. — mcmc_potential_scale_reduction" />
<meta property="og:description" content="Given N &amp;gt; 1 states from each of C &amp;gt; 1 independent chains, the potential
scale reduction factor, commonly referred to as R-hat, measures convergence of
the chains (to the same target) by testing for equality of means." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gelman and Rubin (1992)'s potential scale reduction for chain convergence.</h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/mcmc-functions.R'><code>R/mcmc-functions.R</code></a></small>
    <div class="hidden name"><code>mcmc_potential_scale_reduction.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given <code>N &gt; 1</code> states from each of <code>C &gt; 1</code> independent chains, the potential
scale reduction factor, commonly referred to as R-hat, measures convergence of
the chains (to the same target) by testing for equality of means.</p>
    </div>

    <pre class="usage"><span class='fu'>mcmc_potential_scale_reduction</span><span class='op'>(</span>
  <span class='va'>chains_states</span>,
  independent_chain_ndims <span class='op'>=</span> <span class='fl'>1</span>,
  name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chains_states</th>
      <td><p><code>Tensor</code> or <code>list</code> of <code>Tensor</code>s representing the
state(s) of a Markov Chain at each result step.  The <code>ith</code> state is
assumed to have shape <code>[Ni, Ci1, Ci2,...,CiD] + A</code>.
Dimension <code>0</code> indexes the <code>Ni &gt; 1</code> result steps of the Markov Chain.
Dimensions <code>1</code> through <code>D</code> index the <code>Ci1 x ... x CiD</code> independent
chains to be tested for convergence to the same target.
The remaining dimensions, <code>A</code>, can have any shape (even empty).</p></td>
    </tr>
    <tr>
      <th>independent_chain_ndims</th>
      <td><p>Integer type <code>Tensor</code> with value <code>&gt;= 1</code> giving the
number of giving the number of dimensions, from <code>dim = 1</code> to <code>dim = D</code>,
holding independent chain results to be tested for convergence.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name to prepend to created tf.  Default: <code>potential_scale_reduction</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>Tensor</code> or <code>list</code> of <code>Tensor</code>s representing the R-hat statistic for
the state(s).  Same <code>dtype</code> as <code>state</code>, and shape equal to
<code>state$shape[1 + independent_chain_ndims:]</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Specifically, R-hat measures the degree to which variance (of the means)
between chains exceeds what one would expect if the chains were identically
distributed. See Gelman and Rubin (1992), Brooks and Gelman (1998)].</p>
<p>Some guidelines:</p><ul>
<li><p>The initial state of the chains should be drawn from a distribution overdispersed with respect to the target.</p></li>
<li><p>If all chains converge to the target, then as <code>N --&gt; infinity</code>, R-hat --&gt; 1.
Before that, R-hat &gt; 1 (except in pathological cases, e.g. if the chain paths were identical).</p></li>
<li><p>The above holds for any number of chains <code>C &gt; 1</code>.  Increasing <code>C</code> improves effectiveness of the diagnostic.</p></li>
<li><p>Sometimes, R-hat &lt; 1.2 is used to indicate approximate convergence, but of
course this is problem dependent. See Brooks and Gelman (1998).</p></li>
<li><p>R-hat only measures non-convergence of the mean. If higher moments, or
other statistics are desired, a different diagnostic should be used. See Brooks and Gelman (1998).</p></li>
</ul>

<p>To see why R-hat is reasonable, let <code>X</code> be a random variable drawn uniformly
from the combined states (combined over all chains).  Then, in the limit
<code>N, C --&gt; infinity</code>, with <code>E</code>, <code>Var</code> denoting expectation and variance,
<code>R-hat = ( E[Var[X | chain]] + Var[E[X | chain]] ) / E[Var[X | chain]].</code>
Using the law of total variance, the numerator is the variance of the combined
states, and the denominator is the total variance minus the variance of the
the individual chain means.  If the chains are all drawing from the same
distribution, they will have the same mean, and thus the ratio should be one.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<ul>
<li><p>Stephen P. Brooks and Andrew Gelman. General Methods for Monitoring Convergence of Iterative Simulations.
<em>Journal of Computational and Graphical Statistics</em>, 7(4), 1998.</p></li>
<li><p>Andrew Gelman and Donald B. Rubin. Inference from Iterative Simulation Using Multiple Sequences.
<em>Statistical Science</em>, 7(4):457-472, 1992.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other mcmc_functions: 
<code><a href='mcmc_effective_sample_size.html'>mcmc_effective_sample_size</a>()</code>,
<code><a href='mcmc_sample_annealed_importance_chain.html'>mcmc_sample_annealed_importance_chain</a>()</code>,
<code><a href='mcmc_sample_chain.html'>mcmc_sample_chain</a>()</code>,
<code><a href='mcmc_sample_halton_sequence.html'>mcmc_sample_halton_sequence</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



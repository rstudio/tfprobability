<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A state space model representing a sum of component state space models. — sts_additive_state_space_model • tfprobability</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="A state space model representing a sum of component state space models. — sts_additive_state_space_model" />
<meta property="og:description" content="A state space model (SSM) posits a set of latent (unobserved) variables that
evolve over time with dynamics specified by a probabilistic transition model
p(z[t+1] | z[t]). At each timestep, we observe a value sampled from an
observation model conditioned on the current state, p(x[t] | z[t]). The
special case where both the transition and observation models are Gaussians
with mean specified as a linear function of the inputs, is known as a linear
Gaussian state space model and supports tractable exact probabilistic
calculations; see tfd_linear_gaussian_state_space_model for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dynamic_linear_models.html">Dynamic linear models</a>
    </li>
    <li>
      <a href="../articles/hamiltonian_monte_carlo.html">Multi-level modeling with Hamiltonian Monte Carlo</a>
    </li>
    <li>
      <a href="../articles/layer_dense_variational.html">Uncertainty estimates with layer_dense_variational</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/tfprobability/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A state space model representing a sum of component state space models.</h1>
    <small class="dont-index">Source: <a href='https://github.com/rstudio/tfprobability/blob/master/R/sts.R'><code>R/sts.R</code></a></small>
    <div class="hidden name"><code>sts_additive_state_space_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A state space model (SSM) posits a set of latent (unobserved) variables that
evolve over time with dynamics specified by a probabilistic transition model
<code>p(z[t+1] | z[t])</code>. At each timestep, we observe a value sampled from an
observation model conditioned on the current state, <code>p(x[t] | z[t])</code>. The
special case where both the transition and observation models are Gaussians
with mean specified as a linear function of the inputs, is known as a linear
Gaussian state space model and supports tractable exact probabilistic
calculations; see <code>tfd_linear_gaussian_state_space_model</code> for details.</p>
    </div>

    <pre class="usage"><span class='fu'>sts_additive_state_space_model</span><span class='op'>(</span>
  <span class='va'>component_ssms</span>,
  constant_offset <span class='op'>=</span> <span class='fl'>0</span>,
  observation_noise_scale <span class='op'>=</span> <span class='cn'>NULL</span>,
  initial_state_prior <span class='op'>=</span> <span class='cn'>NULL</span>,
  initial_step <span class='op'>=</span> <span class='fl'>0</span>,
  validate_args <span class='op'>=</span> <span class='cn'>FALSE</span>,
  allow_nan_stats <span class='op'>=</span> <span class='cn'>TRUE</span>,
  name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>component_ssms</th>
      <td><p><code>list</code> containing one or more
<code>tfd_linear_gaussian_state_space_model</code> instances. The components
will in general implement different time-series models, with possibly
different <code>latent_size</code>, but they must have the same <code>dtype</code>, event
shape (<code>num_timesteps</code> and <code>observation_size</code>), and their batch shapes
must broadcast to a compatible batch shape.#'</p></td>
    </tr>
    <tr>
      <th>constant_offset</th>
      <td><p>scalar <code>float</code> <code>tensor</code>, or batch of scalars,
specifying a constant value added to the sum of outputs from the
component models. This allows the components to model the shifted series
<code>observed_time_series - constant_offset</code>. Default value: <code>0</code>.#'</p></td>
    </tr>
    <tr>
      <th>observation_noise_scale</th>
      <td><p>Optional scalar <code>float</code> <code>tensor</code> indicating the
standard deviation of the observation noise. May contain additional
batch dimensions, which must broadcast with the batch shape of elements
in <code>component_ssms</code>. If <code>observation_noise_scale</code> is specified for the
<code>sts_additive_state_space_model</code>, the observation noise scales of component
models are ignored. If <code>NULL</code>, the observation noise scale is derived
by summing the noise variances of the component models, i.e.,
<code>observation_noise_scale = sqrt(sum([ssm.observation_noise_scale**2 for ssm in component_ssms]))</code>.</p></td>
    </tr>
    <tr>
      <th>initial_state_prior</th>
      <td><p>instance of <code>tfd_multivariate_normal</code>
representing the prior distribution on latent states.  Must have
event shape <code>[1]</code> (as <code>tfd_linear_gaussian_state_space_model</code> requires a
rank-1 event shape).</p></td>
    </tr>
    <tr>
      <th>initial_step</th>
      <td><p>Optional scalar <code>integer</code> <code>tensor</code> specifying the starting
timestep. Default value: 0.</p></td>
    </tr>
    <tr>
      <th>validate_args</th>
      <td><p><code>logical</code>. Whether to validate input
with asserts. If <code>validate_args</code> is <code>FALSE</code>, and the inputs are
invalid, correct behavior is not guaranteed. Default value: <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>allow_nan_stats</th>
      <td><p><code>logical</code>. If <code>FALSE</code>, raise an
exception if a statistic (e.g. mean/mode/etc...) is undefined for any
batch member. If <code>TRUE</code>, batch members with valid parameters leading to
undefined statistics will return NaN for this statistic. Default value: <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>string prefixed to ops created by this class.
Default value: "AdditiveStateSpaceModel".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an instance of <code>LinearGaussianStateSpaceModel</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>sts_additive_state_space_model</code> represents a sum of component state space
models. Each of the <code>N</code> components describes a random process
generating a distribution on observed time series <code>x1[t], x2[t], ..., xN[t]</code>.
The additive model represents the sum of these
processes, <code>y[t] = x1[t] + x2[t] + ... + xN[t] + eps[t]</code>, where
<code>eps[t] ~ N(0, observation_noise_scale)</code> is an observation noise term.</p>
<p>Mathematical Details</p>
<p>The additive model concatenates the latent states of its component models.
The generative process runs each component's dynamics in its own subspace of
latent space, and then observes the sum of the observation models from the
components.</p>
<p>Formally, the transition model is linear Gaussian:</p><pre><span class='fu'>p</span><span class='op'>(</span><span class='va'>z</span><span class='op'>[</span><span class='va'>t</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>|</span> <span class='va'>z</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>Normal</a></span><span class='op'>(</span>loc <span class='op'>=</span> <span class='fu'>transition_matrix.matmul</span><span class='op'>(</span><span class='va'>z</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span><span class='op'>)</span>, cov <span class='op'>=</span> <span class='va'>transition_cov</span><span class='op'>)</span>
</pre>

<p>where each <code>z[t]</code> is a latent state vector concatenating the component
state vectors, <code>z[t] = [z1[t], z2[t], ..., zN[t]]</code>, so it has size
<code>latent_size = sum([c.latent_size for c in components])</code>.</p>
<p>The transition matrix is the block-diagonal composition of transition
matrices from the component processes:</p><pre>transition_matrix =
 [[ c0.transition_matrix,  0.,                   ..., 0.                   ],
  [ 0.,                    c1.transition_matrix, ..., 0.                   ],
  [ ...                    ...                   ...                       ],
  [ 0.,                    0.,                   ..., cN.transition_matrix ]]
</pre>

<p>and the noise covariance is similarly the block-diagonal composition of
component noise covariances:</p><pre>transition_cov =
 [[ c0.transition_cov, 0.,                ..., 0.                ],
  [ 0.,                c1.transition_cov, ..., 0.                ],
  [ ...                ...                     ...               ],
  [ 0.,                0.,                ..., cN.transition_cov ]]
</pre>

<p>The observation model is also linear Gaussian,</p><pre><span class='fu'>p</span><span class='op'>(</span><span class='va'>y</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span> <span class='op'>|</span> <span class='va'>z</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>Normal</a></span><span class='op'>(</span>loc <span class='op'>=</span> <span class='fu'>observation_matrix.matmul</span><span class='op'>(</span><span class='va'>z</span><span class='op'>[</span><span class='va'>t</span><span class='op'>]</span><span class='op'>)</span>, stddev <span class='op'>=</span> <span class='va'>observation_noise_scale</span><span class='op'>)</span>
</pre>

<p>This implementation assumes scalar observations, so <code>observation_matrix</code> has shape <code>[1, latent_size]</code>.
The additive observation matrix simply concatenates the observation matrices from each component:</p><pre>observation_matrix = concat([c0.obs_matrix, c1.obs_matrix, ..., cN.obs_matrix], axis=-1)
</pre>

<p>The effect is that each component observation matrix acts on the dimensions
of latent state corresponding to that component, and the overall expected
observation is the sum of the expected observations from each component.</p>
<p>If <code>observation_noise_scale</code> is not explicitly specified, it is also computed
by summing the noise variances of the component processes:</p><pre>observation_noise_scale = sqrt(sum([c.observation_noise_scale**2 for c in components]))
</pre>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other sts: 
<code><a href='sts_autoregressive_state_space_model.html'>sts_autoregressive_state_space_model</a>()</code>,
<code><a href='sts_autoregressive.html'>sts_autoregressive</a>()</code>,
<code><a href='sts_constrained_seasonal_state_space_model.html'>sts_constrained_seasonal_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression_state_space_model.html'>sts_dynamic_linear_regression_state_space_model</a>()</code>,
<code><a href='sts_dynamic_linear_regression.html'>sts_dynamic_linear_regression</a>()</code>,
<code><a href='sts_linear_regression.html'>sts_linear_regression</a>()</code>,
<code><a href='sts_local_level_state_space_model.html'>sts_local_level_state_space_model</a>()</code>,
<code><a href='sts_local_level.html'>sts_local_level</a>()</code>,
<code><a href='sts_local_linear_trend_state_space_model.html'>sts_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_local_linear_trend.html'>sts_local_linear_trend</a>()</code>,
<code><a href='sts_seasonal_state_space_model.html'>sts_seasonal_state_space_model</a>()</code>,
<code><a href='sts_seasonal.html'>sts_seasonal</a>()</code>,
<code><a href='sts_semi_local_linear_trend_state_space_model.html'>sts_semi_local_linear_trend_state_space_model</a>()</code>,
<code><a href='sts_semi_local_linear_trend.html'>sts_semi_local_linear_trend</a>()</code>,
<code><a href='sts_smooth_seasonal_state_space_model.html'>sts_smooth_seasonal_state_space_model</a>()</code>,
<code><a href='sts_smooth_seasonal.html'>sts_smooth_seasonal</a>()</code>,
<code><a href='sts_sparse_linear_regression.html'>sts_sparse_linear_regression</a>()</code>,
<code><a href='sts_sum.html'>sts_sum</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



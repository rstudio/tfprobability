<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>RelaxedBernoulli distribution with temperature and logits parameters. — tfd_relaxed_bernoulli • tfprobability</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="RelaxedBernoulli distribution with temperature and logits parameters. — tfd_relaxed_bernoulli" />

<meta property="og:description" content="The RelaxedBernoulli is a distribution over the unit interval (0,1), which continuously approximates a Bernoulli.
The degree of approximation is controlled by a temperature: as the temperature goes to 0 the RelaxedBernoulli
becomes discrete with a distribution described by the logits or probs parameters, as the temperature goes to
infinity the RelaxedBernoulli becomes the constant distribution that is identically 0.5." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">tfprobability: R bindings to TensorFlow Probability</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RelaxedBernoulli distribution with temperature and logits parameters.</h1>
    
    <div class="hidden name"><code>tfd_relaxed_bernoulli.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The RelaxedBernoulli is a distribution over the unit interval (0,1), which continuously approximates a Bernoulli.
The degree of approximation is controlled by a temperature: as the temperature goes to 0 the RelaxedBernoulli
becomes discrete with a distribution described by the logits or probs parameters, as the temperature goes to
infinity the RelaxedBernoulli becomes the constant distribution that is identically 0.5.</p>
    
    </div>

    <pre class="usage"><span class='fu'>tfd_relaxed_bernoulli</span>(<span class='no'>temperature</span>, <span class='kw'>logits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>validate_args</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>allow_nan_stats</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"RelaxedBernoulli"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>temperature</th>
      <td><p>An 0-D Tensor, representing the temperature of a set of RelaxedBernoulli distributions.
The temperature should be positive.</p></td>
    </tr>
    <tr>
      <th>logits</th>
      <td><p>An N-D Tensor representing the log-odds of a positive event. Each entry in the Tensor
parametrizes an independent RelaxedBernoulli distribution where the probability of an event is sigmoid(logits).
Only one of logits or probs should be passed in.</p></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>AAn N-D Tensor representing the probability of a positive event. Each entry in the Tensor parameterizes
an independent Bernoulli distribution. Only one of logits or probs should be passed in.</p></td>
    </tr>
    <tr>
      <th>validate_args</th>
      <td><p>Logical, default FALSE. When TRUE distribution parameters are checked
for validity despite possibly degrading runtime performance. When FALSE invalid inputs may
silently render incorrect outputs. Default value: FALSE.</p></td>
    </tr>
    <tr>
      <th>allow_nan_stats</th>
      <td><p>Logical, default TRUE. When TRUE, tatistics (e.g., mean, mode, variance)
use the value NaN to indicate the result is undefined. When FALSE, an exception is raised if
one or more of the statistic's batch members are undefined.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name prefixed to Ops created by this class.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The RelaxedBernoulli distribution is a reparameterized continuous
distribution that is the binary special case of the RelaxedOneHotCategorical
distribution (Maddison et al., 2016; Jang et al., 2016). For details on the
binary special case see the appendix of Maddison et al. (2016) where it is
referred to as BinConcrete. If you use this distribution, please cite both papers.</p>
<p>Some care needs to be taken for loss functions that depend on the
log-probability of RelaxedBernoullis, because computing log-probabilities of
the RelaxedBernoulli can suffer from underflow issues. In many case loss
functions such as these are invariant under invertible transformations of
the random variables. The KL divergence, found in the variational autoencoder
loss, is an example. Because RelaxedBernoullis are sampled by a Logistic
random variable followed by a <code>tf$sigmoid</code> op, one solution is to treat
the Logistic as the random variable and <code>tf$sigmoid</code> as downstream. The
KL divergences of two Logistics, which are always followed by a <code>tf.sigmoid</code>
op, is equivalent to evaluating KL divergences of RelaxedBernoulli samples.
See Maddison et al., 2016 for more details where this distribution is called
the BinConcrete.
An alternative approach is to evaluate Bernoulli log probability or KL
directly on relaxed samples, as done in Jang et al., 2016. In this case,
guarantees on the loss are usually violated. For instance, using a Bernoulli
KL in a relaxed ELBO is no longer a lower bound on the log marginal
probability of the observation. Thus care and early stopping are important.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other distributions: <code><a href='tfd_bernoulli.html'>tfd_bernoulli</a></code>,
  <code><a href='tfd_categorical.html'>tfd_categorical</a></code>,
  <code><a href='tfd_independent.html'>tfd_independent</a></code>, <code><a href='tfd_mixture.html'>tfd_mixture</a></code>,
  <code><a href='tfd_multinomial.html'>tfd_multinomial</a></code>,
  <code><a href='tfd_multivariate_normal_diag_plus_low_rank.html'>tfd_multivariate_normal_diag_plus_low_rank</a></code>,
  <code><a href='tfd_multivariate_normal_diag.html'>tfd_multivariate_normal_diag</a></code>,
  <code><a href='tfd_multivariate_normal_full_covariance.html'>tfd_multivariate_normal_full_covariance</a></code>,
  <code><a href='tfd_multivariate_normal_linear_operator.html'>tfd_multivariate_normal_linear_operator</a></code>,
  <code><a href='tfd_multivariate_normal_tri_l.html'>tfd_multivariate_normal_tri_l</a></code>,
  <code><a href='tfd_multivariate_student_t_linear_operator.html'>tfd_multivariate_student_t_linear_operator</a></code>,
  <code><a href='tfd_negative_binomial.html'>tfd_negative_binomial</a></code>,
  <code><a href='tfd_normal.html'>tfd_normal</a></code>,
  <code><a href='tfd_one_hot_categorical.html'>tfd_one_hot_categorical</a></code>,
  <code><a href='tfd_pareto.html'>tfd_pareto</a></code>,
  <code><a href='tfd_poisson_log_normal_quadrature_compound.html'>tfd_poisson_log_normal_quadrature_compound</a></code>,
  <code><a href='tfd_poisson.html'>tfd_poisson</a></code>, <code><a href='tfd_quantized.html'>tfd_quantized</a></code>,
  <code><a href='tfd_relaxed_one_hot_categorical.html'>tfd_relaxed_one_hot_categorical</a></code>,
  <code><a href='tfd_sinh_arcsinh.html'>tfd_sinh_arcsinh</a></code>,
  <code><a href='tfd_student_t_process.html'>tfd_student_t_process</a></code>,
  <code><a href='tfd_student_t.html'>tfd_student_t</a></code>,
  <code><a href='tfd_transformed.html'>tfd_transformed</a></code>,
  <code><a href='tfd_triangular.html'>tfd_triangular</a></code>,
  <code><a href='tfd_truncated_normal.html'>tfd_truncated_normal</a></code>,
  <code><a href='tfd_uniform.html'>tfd_uniform</a></code>,
  <code><a href='tfd_variational_gaussian_process.html'>tfd_variational_gaussian_process</a></code>,
  <code><a href='tfd_vector_diffeomixture.html'>tfd_vector_diffeomixture</a></code>,
  <code><a href='tfd_vector_exponential_diag.html'>tfd_vector_exponential_diag</a></code>,
  <code><a href='tfd_vector_exponential_linear_operator.html'>tfd_vector_exponential_linear_operator</a></code>,
  <code><a href='tfd_vector_laplace_diag.html'>tfd_vector_laplace_diag</a></code>,
  <code><a href='tfd_vector_laplace_linear_operator.html'>tfd_vector_laplace_linear_operator</a></code>,
  <code><a href='tfd_vector_sinh_arcsinh_diag.html'>tfd_vector_sinh_arcsinh_diag</a></code>,
  <code><a href='tfd_von_mises_fisher.html'>tfd_von_mises_fisher</a></code>,
  <code><a href='tfd_von_mises.html'>tfd_von_mises</a></code>, <code><a href='tfd_wishart.html'>tfd_wishart</a></code>,
  <code><a href='tfd_zipf.html'>tfd_zipf</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sigrid Keydana, Kevin Kuo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

